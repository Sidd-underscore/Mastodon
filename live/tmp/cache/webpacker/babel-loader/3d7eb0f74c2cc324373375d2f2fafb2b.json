{"ast":null,"code":"var _jsxFileName = \"/home/runner/Mastodon/live/app/javascript/mastodon/features/getting_started/components/announcements.js\",\n    _class,\n    _class2,\n    _temp;\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nimport React from 'react';\nimport ImmutablePureComponent from 'react-immutable-pure-component';\nimport ReactSwipeableViews from 'react-swipeable-views';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport PropTypes from 'prop-types';\nimport IconButton from 'mastodon/components/icon_button';\nimport Icon from 'mastodon/components/icon';\nimport { defineMessages, injectIntl, FormattedMessage, FormattedDate } from 'react-intl';\nimport { autoPlayGif, reduceMotion, disableSwiping } from 'mastodon/initial_state';\nimport elephantUIPlane from 'mastodon/../images/elephant_ui_plane.svg';\nimport { mascot } from 'mastodon/initial_state';\nimport unicodeMapping from 'mastodon/features/emoji/emoji_unicode_mapping_light';\nimport classNames from 'classnames';\nimport EmojiPickerDropdown from 'mastodon/features/compose/containers/emoji_picker_dropdown_container';\nimport AnimatedNumber from 'mastodon/components/animated_number';\nimport TransitionMotion from 'react-motion/lib/TransitionMotion';\nimport spring from 'react-motion/lib/spring';\nimport { assetHost } from 'mastodon/utils/config';\nvar messages = defineMessages({\n  close: {\n    \"id\": \"lightbox.close\",\n    \"defaultMessage\": \"Close\"\n  },\n  previous: {\n    \"id\": \"lightbox.previous\",\n    \"defaultMessage\": \"Previous\"\n  },\n  next: {\n    \"id\": \"lightbox.next\",\n    \"defaultMessage\": \"Next\"\n  }\n});\n\nvar Content = /*#__PURE__*/function (_ImmutablePureCompone) {\n  _inheritsLoose(Content, _ImmutablePureCompone);\n\n  function Content() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _ImmutablePureCompone.call.apply(_ImmutablePureCompone, [this].concat(args)) || this;\n\n    _this.setRef = function (c) {\n      _this.node = c;\n    };\n\n    _this.onMentionClick = function (mention, e) {\n      if (_this.context.router && e.button === 0 && !(e.ctrlKey || e.metaKey)) {\n        e.preventDefault();\n\n        _this.context.router.history.push(\"/accounts/\" + mention.get('id'));\n      }\n    };\n\n    _this.onHashtagClick = function (hashtag, e) {\n      hashtag = hashtag.replace(/^#/, '');\n\n      if (_this.context.router && e.button === 0 && !(e.ctrlKey || e.metaKey)) {\n        e.preventDefault();\n\n        _this.context.router.history.push(\"/timelines/tag/\" + hashtag);\n      }\n    };\n\n    _this.onStatusClick = function (status, e) {\n      if (_this.context.router && e.button === 0 && !(e.ctrlKey || e.metaKey)) {\n        e.preventDefault();\n\n        _this.context.router.history.push(\"/statuses/\" + status.get('id'));\n      }\n    };\n\n    _this.handleMouseEnter = function (_ref) {\n      var currentTarget = _ref.currentTarget;\n\n      if (autoPlayGif) {\n        return;\n      }\n\n      var emojis = currentTarget.querySelectorAll('.custom-emoji');\n\n      for (var i = 0; i < emojis.length; i++) {\n        var emoji = emojis[i];\n        emoji.src = emoji.getAttribute('data-original');\n      }\n    };\n\n    _this.handleMouseLeave = function (_ref2) {\n      var currentTarget = _ref2.currentTarget;\n\n      if (autoPlayGif) {\n        return;\n      }\n\n      var emojis = currentTarget.querySelectorAll('.custom-emoji');\n\n      for (var i = 0; i < emojis.length; i++) {\n        var emoji = emojis[i];\n        emoji.src = emoji.getAttribute('data-static');\n      }\n    };\n\n    return _this;\n  }\n\n  var _proto = Content.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    this._updateLinks();\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate() {\n    this._updateLinks();\n  };\n\n  _proto._updateLinks = function _updateLinks() {\n    var _this2 = this;\n\n    var node = this.node;\n\n    if (!node) {\n      return;\n    }\n\n    var links = node.querySelectorAll('a');\n\n    var _loop = function _loop() {\n      var link = links[i];\n\n      if (link.classList.contains('status-link')) {\n        return \"continue\";\n      }\n\n      link.classList.add('status-link');\n\n      var mention = _this2.props.announcement.get('mentions').find(function (item) {\n        return link.href === item.get('url');\n      });\n\n      if (mention) {\n        link.addEventListener('click', _this2.onMentionClick.bind(_this2, mention), false);\n        link.setAttribute('title', mention.get('acct'));\n      } else if (link.textContent[0] === '#' || link.previousSibling && link.previousSibling.textContent && link.previousSibling.textContent[link.previousSibling.textContent.length - 1] === '#') {\n        link.addEventListener('click', _this2.onHashtagClick.bind(_this2, link.text), false);\n      } else {\n        var status = _this2.props.announcement.get('statuses').find(function (item) {\n          return link.href === item.get('url');\n        });\n\n        if (status) {\n          link.addEventListener('click', _this2.onStatusClick.bind(_this2, status), false);\n        }\n\n        link.setAttribute('title', link.href);\n        link.classList.add('unhandled-link');\n      }\n\n      link.setAttribute('target', '_blank');\n      link.setAttribute('rel', 'noopener noreferrer');\n    };\n\n    for (var i = 0; i < links.length; ++i) {\n      var _ret = _loop();\n\n      if (_ret === \"continue\") continue;\n    }\n  };\n\n  _proto.render = function render() {\n    var announcement = this.props.announcement;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"announcements__item__content translate\",\n      ref: this.setRef,\n      dangerouslySetInnerHTML: {\n        __html: announcement.get('contentHtml')\n      },\n      onMouseEnter: this.handleMouseEnter,\n      onMouseLeave: this.handleMouseLeave,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 7\n      }\n    });\n  };\n\n  return Content;\n}(ImmutablePureComponent);\n\nContent.contextTypes = {\n  router: PropTypes.object\n};\nContent.propTypes = {\n  announcement: ImmutablePropTypes.map.isRequired\n};\n\nvar Emoji = /*#__PURE__*/function (_React$PureComponent) {\n  _inheritsLoose(Emoji, _React$PureComponent);\n\n  function Emoji() {\n    return _React$PureComponent.apply(this, arguments) || this;\n  }\n\n  var _proto2 = Emoji.prototype;\n\n  _proto2.render = function render() {\n    var _this$props = this.props,\n        emoji = _this$props.emoji,\n        emojiMap = _this$props.emojiMap,\n        hovered = _this$props.hovered;\n\n    if (unicodeMapping[emoji]) {\n      var _unicodeMapping$this$ = unicodeMapping[this.props.emoji],\n          filename = _unicodeMapping$this$.filename,\n          shortCode = _unicodeMapping$this$.shortCode;\n      var title = shortCode ? \":\" + shortCode + \":\" : '';\n      return /*#__PURE__*/React.createElement(\"img\", {\n        draggable: \"false\",\n        className: \"emojione\",\n        alt: emoji,\n        title: title,\n        src: assetHost + \"/emoji/\" + filename + \".svg\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 9\n        }\n      });\n    } else if (emojiMap.get(emoji)) {\n      var _filename = autoPlayGif || hovered ? emojiMap.getIn([emoji, 'url']) : emojiMap.getIn([emoji, 'static_url']);\n\n      var _shortCode = \":\" + emoji + \":\";\n\n      return /*#__PURE__*/React.createElement(\"img\", {\n        draggable: \"false\",\n        className: \"emojione custom-emoji\",\n        alt: _shortCode,\n        title: _shortCode,\n        src: _filename,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 9\n        }\n      });\n    } else {\n      return null;\n    }\n  };\n\n  return Emoji;\n}(React.PureComponent);\n\nEmoji.propTypes = {\n  emoji: PropTypes.string.isRequired,\n  emojiMap: ImmutablePropTypes.map.isRequired,\n  hovered: PropTypes.bool.isRequired\n};\n\nvar Reaction = /*#__PURE__*/function (_ImmutablePureCompone2) {\n  _inheritsLoose(Reaction, _ImmutablePureCompone2);\n\n  function Reaction() {\n    var _this3;\n\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    _this3 = _ImmutablePureCompone2.call.apply(_ImmutablePureCompone2, [this].concat(args)) || this;\n    _this3.state = {\n      hovered: false\n    };\n\n    _this3.handleClick = function () {\n      var _this3$props = _this3.props,\n          reaction = _this3$props.reaction,\n          announcementId = _this3$props.announcementId,\n          addReaction = _this3$props.addReaction,\n          removeReaction = _this3$props.removeReaction;\n\n      if (reaction.get('me')) {\n        removeReaction(announcementId, reaction.get('name'));\n      } else {\n        addReaction(announcementId, reaction.get('name'));\n      }\n    };\n\n    _this3.handleMouseEnter = function () {\n      return _this3.setState({\n        hovered: true\n      });\n    };\n\n    _this3.handleMouseLeave = function () {\n      return _this3.setState({\n        hovered: false\n      });\n    };\n\n    return _this3;\n  }\n\n  var _proto3 = Reaction.prototype;\n\n  _proto3.render = function render() {\n    var reaction = this.props.reaction;\n    var shortCode = reaction.get('name');\n\n    if (unicodeMapping[shortCode]) {\n      shortCode = unicodeMapping[shortCode].shortCode;\n    }\n\n    return /*#__PURE__*/React.createElement(\"button\", {\n      className: classNames('reactions-bar__item', {\n        active: reaction.get('me')\n      }),\n      onClick: this.handleClick,\n      onMouseEnter: this.handleMouseEnter,\n      onMouseLeave: this.handleMouseLeave,\n      title: \":\" + shortCode + \":\",\n      style: this.props.style,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"reactions-bar__item__emoji\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Emoji, {\n      hovered: this.state.hovered,\n      emoji: reaction.get('name'),\n      emojiMap: this.props.emojiMap,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 54\n      }\n    })), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"reactions-bar__item__count\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(AnimatedNumber, {\n      value: reaction.get('count'),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 54\n      }\n    })));\n  };\n\n  return Reaction;\n}(ImmutablePureComponent);\n\nReaction.propTypes = {\n  announcementId: PropTypes.string.isRequired,\n  reaction: ImmutablePropTypes.map.isRequired,\n  addReaction: PropTypes.func.isRequired,\n  removeReaction: PropTypes.func.isRequired,\n  emojiMap: ImmutablePropTypes.map.isRequired,\n  style: PropTypes.object\n};\n\nvar ReactionsBar = /*#__PURE__*/function (_ImmutablePureCompone3) {\n  _inheritsLoose(ReactionsBar, _ImmutablePureCompone3);\n\n  function ReactionsBar() {\n    var _this4;\n\n    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n      args[_key3] = arguments[_key3];\n    }\n\n    _this4 = _ImmutablePureCompone3.call.apply(_ImmutablePureCompone3, [this].concat(args)) || this;\n\n    _this4.handleEmojiPick = function (data) {\n      var _this4$props = _this4.props,\n          addReaction = _this4$props.addReaction,\n          announcementId = _this4$props.announcementId;\n      addReaction(announcementId, data.native.replace(/:/g, ''));\n    };\n\n    return _this4;\n  }\n\n  var _proto4 = ReactionsBar.prototype;\n\n  _proto4.willEnter = function willEnter() {\n    return {\n      scale: reduceMotion ? 1 : 0\n    };\n  };\n\n  _proto4.willLeave = function willLeave() {\n    return {\n      scale: reduceMotion ? 0 : spring(0, {\n        stiffness: 170,\n        damping: 26\n      })\n    };\n  };\n\n  _proto4.render = function render() {\n    var _this5 = this;\n\n    var reactions = this.props.reactions;\n    var visibleReactions = reactions.filter(function (x) {\n      return x.get('count') > 0;\n    });\n    var styles = visibleReactions.map(function (reaction) {\n      return {\n        key: reaction.get('name'),\n        data: reaction,\n        style: {\n          scale: reduceMotion ? 1 : spring(1, {\n            stiffness: 150,\n            damping: 13\n          })\n        }\n      };\n    }).toArray();\n    return /*#__PURE__*/React.createElement(TransitionMotion, {\n      styles: styles,\n      willEnter: this.willEnter,\n      willLeave: this.willLeave,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 7\n      }\n    }, function (items) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: classNames('reactions-bar', {\n          'reactions-bar--empty': visibleReactions.isEmpty()\n        }),\n        __self: _this5,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 11\n        }\n      }, items.map(function (_ref3) {\n        var key = _ref3.key,\n            data = _ref3.data,\n            style = _ref3.style;\n        return /*#__PURE__*/React.createElement(Reaction, {\n          key: key,\n          reaction: data,\n          style: {\n            transform: \"scale(\" + style.scale + \")\",\n            position: style.scale < 0.5 ? 'absolute' : 'static'\n          },\n          announcementId: _this5.props.announcementId,\n          addReaction: _this5.props.addReaction,\n          removeReaction: _this5.props.removeReaction,\n          emojiMap: _this5.props.emojiMap,\n          __self: _this5,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 15\n          }\n        });\n      }), visibleReactions.size < 8 && /*#__PURE__*/React.createElement(EmojiPickerDropdown, {\n        onPickEmoji: _this5.handleEmojiPick,\n        button: /*#__PURE__*/React.createElement(Icon, {\n          id: \"plus\",\n          __self: _this5,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 107\n          }\n        }),\n        __self: _this5,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 43\n        }\n      }));\n    });\n  };\n\n  return ReactionsBar;\n}(ImmutablePureComponent);\n\nReactionsBar.propTypes = {\n  announcementId: PropTypes.string.isRequired,\n  reactions: ImmutablePropTypes.list.isRequired,\n  addReaction: PropTypes.func.isRequired,\n  removeReaction: PropTypes.func.isRequired,\n  emojiMap: ImmutablePropTypes.map.isRequired\n};\n\nvar Announcement = /*#__PURE__*/function (_ImmutablePureCompone4) {\n  _inheritsLoose(Announcement, _ImmutablePureCompone4);\n\n  function Announcement() {\n    var _this6;\n\n    for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n      args[_key4] = arguments[_key4];\n    }\n\n    _this6 = _ImmutablePureCompone4.call.apply(_ImmutablePureCompone4, [this].concat(args)) || this;\n    _this6.state = {\n      unread: !_this6.props.announcement.get('read')\n    };\n    return _this6;\n  }\n\n  var _proto5 = Announcement.prototype;\n\n  _proto5.componentDidUpdate = function componentDidUpdate() {\n    var _this$props2 = this.props,\n        selected = _this$props2.selected,\n        announcement = _this$props2.announcement;\n\n    if (!selected && this.state.unread !== !announcement.get('read')) {\n      this.setState({\n        unread: !announcement.get('read')\n      });\n    }\n  };\n\n  _proto5.render = function render() {\n    var announcement = this.props.announcement;\n    var unread = this.state.unread;\n    var startsAt = announcement.get('starts_at') && new Date(announcement.get('starts_at'));\n    var endsAt = announcement.get('ends_at') && new Date(announcement.get('ends_at'));\n    var now = new Date();\n    var hasTimeRange = startsAt && endsAt;\n    var skipYear = hasTimeRange && startsAt.getFullYear() === endsAt.getFullYear() && endsAt.getFullYear() === now.getFullYear();\n    var skipEndDate = hasTimeRange && startsAt.getDate() === endsAt.getDate() && startsAt.getMonth() === endsAt.getMonth() && startsAt.getFullYear() === endsAt.getFullYear();\n    var skipTime = announcement.get('all_day');\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"announcements__item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      className: \"announcements__item__range\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(FormattedMessage, {\n      id: \"announcement.announcement\",\n      defaultMessage: \"Announcement\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 11\n      }\n    }), hasTimeRange && /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 28\n      }\n    }, \" \\xB7 \", /*#__PURE__*/React.createElement(FormattedDate, {\n      value: startsAt,\n      hour12: false,\n      year: skipYear || startsAt.getFullYear() === now.getFullYear() ? undefined : 'numeric',\n      month: \"short\",\n      day: \"2-digit\",\n      hour: skipTime ? undefined : '2-digit',\n      minute: skipTime ? undefined : '2-digit',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 37\n      }\n    }), \" - \", /*#__PURE__*/React.createElement(FormattedDate, {\n      value: endsAt,\n      hour12: false,\n      year: skipYear || endsAt.getFullYear() === now.getFullYear() ? undefined : 'numeric',\n      month: skipEndDate ? undefined : 'short',\n      day: skipEndDate ? undefined : '2-digit',\n      hour: skipTime ? undefined : '2-digit',\n      minute: skipTime ? undefined : '2-digit',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 289\n      }\n    }))), /*#__PURE__*/React.createElement(Content, {\n      announcement: announcement,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(ReactionsBar, {\n      reactions: announcement.get('reactions'),\n      announcementId: announcement.get('id'),\n      addReaction: this.props.addReaction,\n      removeReaction: this.props.removeReaction,\n      emojiMap: this.props.emojiMap,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 9\n      }\n    }), unread && /*#__PURE__*/React.createElement(\"span\", {\n      className: \"announcements__item__unread\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 20\n      }\n    }));\n  };\n\n  return Announcement;\n}(ImmutablePureComponent);\n\nAnnouncement.propTypes = {\n  announcement: ImmutablePropTypes.map.isRequired,\n  emojiMap: ImmutablePropTypes.map.isRequired,\n  addReaction: PropTypes.func.isRequired,\n  removeReaction: PropTypes.func.isRequired,\n  intl: PropTypes.object.isRequired,\n  selected: PropTypes.bool\n};\n\nvar Announcements = injectIntl(_class = (_temp = _class2 = /*#__PURE__*/function (_ImmutablePureCompone5) {\n  _inheritsLoose(Announcements, _ImmutablePureCompone5);\n\n  function Announcements() {\n    var _this7;\n\n    for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n      args[_key5] = arguments[_key5];\n    }\n\n    _this7 = _ImmutablePureCompone5.call.apply(_ImmutablePureCompone5, [this].concat(args)) || this;\n    _this7.state = {\n      index: 0\n    };\n\n    _this7.handleChangeIndex = function (index) {\n      _this7.setState({\n        index: index % _this7.props.announcements.size\n      });\n    };\n\n    _this7.handleNextClick = function () {\n      _this7.setState({\n        index: (_this7.state.index + 1) % _this7.props.announcements.size\n      });\n    };\n\n    _this7.handlePrevClick = function () {\n      _this7.setState({\n        index: (_this7.props.announcements.size + _this7.state.index - 1) % _this7.props.announcements.size\n      });\n    };\n\n    return _this7;\n  }\n\n  Announcements.getDerivedStateFromProps = function getDerivedStateFromProps(props, state) {\n    if (props.announcements.size > 0 && state.index >= props.announcements.size) {\n      return {\n        index: props.announcements.size - 1\n      };\n    } else {\n      return null;\n    }\n  };\n\n  var _proto6 = Announcements.prototype;\n\n  _proto6.componentDidMount = function componentDidMount() {\n    this._markAnnouncementAsRead();\n  };\n\n  _proto6.componentDidUpdate = function componentDidUpdate() {\n    this._markAnnouncementAsRead();\n  };\n\n  _proto6._markAnnouncementAsRead = function _markAnnouncementAsRead() {\n    var _this$props3 = this.props,\n        dismissAnnouncement = _this$props3.dismissAnnouncement,\n        announcements = _this$props3.announcements;\n    var index = this.state.index;\n    var announcement = announcements.get(announcements.size - 1 - index);\n    if (!announcement.get('read')) dismissAnnouncement(announcement.get('id'));\n  };\n\n  _proto6.render = function render() {\n    var _this8 = this;\n\n    var _this$props4 = this.props,\n        announcements = _this$props4.announcements,\n        intl = _this$props4.intl;\n    var index = this.state.index;\n\n    if (announcements.isEmpty()) {\n      return null;\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"announcements\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 419,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"announcements__mastodon\",\n      alt: \"\",\n      draggable: \"false\",\n      src: mascot || elephantUIPlane,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 420,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"announcements__container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(ReactSwipeableViews, {\n      animateHeight: !reduceMotion,\n      adjustHeight: reduceMotion,\n      index: index,\n      onChangeIndex: this.handleChangeIndex,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 11\n      }\n    }, announcements.map(function (announcement, idx) {\n      return /*#__PURE__*/React.createElement(Announcement, {\n        key: announcement.get('id'),\n        announcement: announcement,\n        emojiMap: _this8.props.emojiMap,\n        addReaction: _this8.props.addReaction,\n        removeReaction: _this8.props.removeReaction,\n        intl: intl,\n        selected: index === idx,\n        disabled: disableSwiping,\n        __self: _this8,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 15\n        }\n      });\n    }).reverse()), announcements.size > 1 && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"announcements__pagination\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 439,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(IconButton, {\n      disabled: announcements.size === 1,\n      title: intl.formatMessage(messages.previous),\n      icon: \"chevron-left\",\n      onClick: this.handlePrevClick,\n      size: 13,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 440,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 15\n      }\n    }, index + 1, \" / \", announcements.size), /*#__PURE__*/React.createElement(IconButton, {\n      disabled: announcements.size === 1,\n      title: intl.formatMessage(messages.next),\n      icon: \"chevron-right\",\n      onClick: this.handleNextClick,\n      size: 13,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 442,\n        columnNumber: 15\n      }\n    }))));\n  };\n\n  return Announcements;\n}(ImmutablePureComponent), _class2.propTypes = {\n  announcements: ImmutablePropTypes.list,\n  emojiMap: ImmutablePropTypes.map.isRequired,\n  dismissAnnouncement: PropTypes.func.isRequired,\n  addReaction: PropTypes.func.isRequired,\n  removeReaction: PropTypes.func.isRequired,\n  intl: PropTypes.object.isRequired\n}, _temp)) || _class;\n\nexport { Announcements as default };","map":{"version":3,"sources":["/home/runner/Mastodon/live/app/javascript/mastodon/features/getting_started/components/announcements.js"],"names":["React","ImmutablePureComponent","ReactSwipeableViews","ImmutablePropTypes","PropTypes","IconButton","Icon","defineMessages","injectIntl","FormattedMessage","FormattedDate","autoPlayGif","reduceMotion","disableSwiping","elephantUIPlane","mascot","unicodeMapping","classNames","EmojiPickerDropdown","AnimatedNumber","TransitionMotion","spring","assetHost","messages","close","previous","next","Content","setRef","c","node","onMentionClick","mention","e","context","router","button","ctrlKey","metaKey","preventDefault","history","push","get","onHashtagClick","hashtag","replace","onStatusClick","status","handleMouseEnter","currentTarget","emojis","querySelectorAll","i","length","emoji","src","getAttribute","handleMouseLeave","componentDidMount","_updateLinks","componentDidUpdate","links","link","classList","contains","add","props","announcement","find","item","href","addEventListener","bind","setAttribute","textContent","previousSibling","text","render","__html","contextTypes","object","propTypes","map","isRequired","Emoji","emojiMap","hovered","filename","shortCode","title","getIn","PureComponent","string","bool","Reaction","state","handleClick","reaction","announcementId","addReaction","removeReaction","setState","active","style","func","ReactionsBar","handleEmojiPick","data","native","willEnter","scale","willLeave","stiffness","damping","reactions","visibleReactions","filter","x","styles","key","toArray","items","isEmpty","transform","position","size","list","Announcement","unread","selected","startsAt","Date","endsAt","now","hasTimeRange","skipYear","getFullYear","skipEndDate","getDate","getMonth","skipTime","undefined","intl","Announcements","index","handleChangeIndex","announcements","handleNextClick","handlePrevClick","getDerivedStateFromProps","_markAnnouncementAsRead","dismissAnnouncement","idx","reverse","formatMessage"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ImmutablePureComponent from 'react-immutable-pure-component';\nimport ReactSwipeableViews from 'react-swipeable-views';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport PropTypes from 'prop-types';\nimport IconButton from 'mastodon/components/icon_button';\nimport Icon from 'mastodon/components/icon';\nimport { defineMessages, injectIntl, FormattedMessage, FormattedDate } from 'react-intl';\nimport { autoPlayGif, reduceMotion, disableSwiping } from 'mastodon/initial_state';\nimport elephantUIPlane from 'mastodon/../images/elephant_ui_plane.svg';\nimport { mascot } from 'mastodon/initial_state';\nimport unicodeMapping from 'mastodon/features/emoji/emoji_unicode_mapping_light';\nimport classNames from 'classnames';\nimport EmojiPickerDropdown from 'mastodon/features/compose/containers/emoji_picker_dropdown_container';\nimport AnimatedNumber from 'mastodon/components/animated_number';\nimport TransitionMotion from 'react-motion/lib/TransitionMotion';\nimport spring from 'react-motion/lib/spring';\nimport { assetHost } from 'mastodon/utils/config';\n\nconst messages = defineMessages({\n  close: { id: 'lightbox.close', defaultMessage: 'Close' },\n  previous: { id: 'lightbox.previous', defaultMessage: 'Previous' },\n  next: { id: 'lightbox.next', defaultMessage: 'Next' },\n});\n\nclass Content extends ImmutablePureComponent {\n\n  static contextTypes = {\n    router: PropTypes.object,\n  };\n\n  static propTypes = {\n    announcement: ImmutablePropTypes.map.isRequired,\n  };\n\n  setRef = c => {\n    this.node = c;\n  }\n\n  componentDidMount () {\n    this._updateLinks();\n  }\n\n  componentDidUpdate () {\n    this._updateLinks();\n  }\n\n  _updateLinks () {\n    const node = this.node;\n\n    if (!node) {\n      return;\n    }\n\n    const links = node.querySelectorAll('a');\n\n    for (var i = 0; i < links.length; ++i) {\n      let link = links[i];\n\n      if (link.classList.contains('status-link')) {\n        continue;\n      }\n\n      link.classList.add('status-link');\n\n      let mention = this.props.announcement.get('mentions').find(item => link.href === item.get('url'));\n\n      if (mention) {\n        link.addEventListener('click', this.onMentionClick.bind(this, mention), false);\n        link.setAttribute('title', mention.get('acct'));\n      } else if (link.textContent[0] === '#' || (link.previousSibling && link.previousSibling.textContent && link.previousSibling.textContent[link.previousSibling.textContent.length - 1] === '#')) {\n        link.addEventListener('click', this.onHashtagClick.bind(this, link.text), false);\n      } else {\n        let status = this.props.announcement.get('statuses').find(item => link.href === item.get('url'));\n        if (status) {\n          link.addEventListener('click', this.onStatusClick.bind(this, status), false);\n        }\n        link.setAttribute('title', link.href);\n        link.classList.add('unhandled-link');\n      }\n\n      link.setAttribute('target', '_blank');\n      link.setAttribute('rel', 'noopener noreferrer');\n    }\n  }\n\n  onMentionClick = (mention, e) => {\n    if (this.context.router && e.button === 0 && !(e.ctrlKey || e.metaKey)) {\n      e.preventDefault();\n      this.context.router.history.push(`/accounts/${mention.get('id')}`);\n    }\n  }\n\n  onHashtagClick = (hashtag, e) => {\n    hashtag = hashtag.replace(/^#/, '');\n\n    if (this.context.router && e.button === 0 && !(e.ctrlKey || e.metaKey)) {\n      e.preventDefault();\n      this.context.router.history.push(`/timelines/tag/${hashtag}`);\n    }\n  }\n\n  onStatusClick = (status, e) => {\n    if (this.context.router && e.button === 0 && !(e.ctrlKey || e.metaKey)) {\n      e.preventDefault();\n      this.context.router.history.push(`/statuses/${status.get('id')}`);\n    }\n  }\n\n  handleMouseEnter = ({ currentTarget }) => {\n    if (autoPlayGif) {\n      return;\n    }\n\n    const emojis = currentTarget.querySelectorAll('.custom-emoji');\n\n    for (var i = 0; i < emojis.length; i++) {\n      let emoji = emojis[i];\n      emoji.src = emoji.getAttribute('data-original');\n    }\n  }\n\n  handleMouseLeave = ({ currentTarget }) => {\n    if (autoPlayGif) {\n      return;\n    }\n\n    const emojis = currentTarget.querySelectorAll('.custom-emoji');\n\n    for (var i = 0; i < emojis.length; i++) {\n      let emoji = emojis[i];\n      emoji.src = emoji.getAttribute('data-static');\n    }\n  }\n\n  render () {\n    const { announcement } = this.props;\n\n    return (\n      <div\n        className='announcements__item__content translate'\n        ref={this.setRef}\n        dangerouslySetInnerHTML={{ __html: announcement.get('contentHtml') }}\n        onMouseEnter={this.handleMouseEnter}\n        onMouseLeave={this.handleMouseLeave}\n      />\n    );\n  }\n\n}\n\nclass Emoji extends React.PureComponent {\n\n  static propTypes = {\n    emoji: PropTypes.string.isRequired,\n    emojiMap: ImmutablePropTypes.map.isRequired,\n    hovered: PropTypes.bool.isRequired,\n  };\n\n  render () {\n    const { emoji, emojiMap, hovered } = this.props;\n\n    if (unicodeMapping[emoji]) {\n      const { filename, shortCode } = unicodeMapping[this.props.emoji];\n      const title = shortCode ? `:${shortCode}:` : '';\n\n      return (\n        <img\n          draggable='false'\n          className='emojione'\n          alt={emoji}\n          title={title}\n          src={`${assetHost}/emoji/${filename}.svg`}\n        />\n      );\n    } else if (emojiMap.get(emoji)) {\n      const filename  = (autoPlayGif || hovered) ? emojiMap.getIn([emoji, 'url']) : emojiMap.getIn([emoji, 'static_url']);\n      const shortCode = `:${emoji}:`;\n\n      return (\n        <img\n          draggable='false'\n          className='emojione custom-emoji'\n          alt={shortCode}\n          title={shortCode}\n          src={filename}\n        />\n      );\n    } else {\n      return null;\n    }\n  }\n\n}\n\nclass Reaction extends ImmutablePureComponent {\n\n  static propTypes = {\n    announcementId: PropTypes.string.isRequired,\n    reaction: ImmutablePropTypes.map.isRequired,\n    addReaction: PropTypes.func.isRequired,\n    removeReaction: PropTypes.func.isRequired,\n    emojiMap: ImmutablePropTypes.map.isRequired,\n    style: PropTypes.object,\n  };\n\n  state = {\n    hovered: false,\n  };\n\n  handleClick = () => {\n    const { reaction, announcementId, addReaction, removeReaction } = this.props;\n\n    if (reaction.get('me')) {\n      removeReaction(announcementId, reaction.get('name'));\n    } else {\n      addReaction(announcementId, reaction.get('name'));\n    }\n  }\n\n  handleMouseEnter = () => this.setState({ hovered: true })\n\n  handleMouseLeave = () => this.setState({ hovered: false })\n\n  render () {\n    const { reaction } = this.props;\n\n    let shortCode = reaction.get('name');\n\n    if (unicodeMapping[shortCode]) {\n      shortCode = unicodeMapping[shortCode].shortCode;\n    }\n\n    return (\n      <button className={classNames('reactions-bar__item', { active: reaction.get('me') })} onClick={this.handleClick} onMouseEnter={this.handleMouseEnter} onMouseLeave={this.handleMouseLeave} title={`:${shortCode}:`} style={this.props.style}>\n        <span className='reactions-bar__item__emoji'><Emoji hovered={this.state.hovered} emoji={reaction.get('name')} emojiMap={this.props.emojiMap} /></span>\n        <span className='reactions-bar__item__count'><AnimatedNumber value={reaction.get('count')} /></span>\n      </button>\n    );\n  }\n\n}\n\nclass ReactionsBar extends ImmutablePureComponent {\n\n  static propTypes = {\n    announcementId: PropTypes.string.isRequired,\n    reactions: ImmutablePropTypes.list.isRequired,\n    addReaction: PropTypes.func.isRequired,\n    removeReaction: PropTypes.func.isRequired,\n    emojiMap: ImmutablePropTypes.map.isRequired,\n  };\n\n  handleEmojiPick = data => {\n    const { addReaction, announcementId } = this.props;\n    addReaction(announcementId, data.native.replace(/:/g, ''));\n  }\n\n  willEnter () {\n    return { scale: reduceMotion ? 1 : 0 };\n  }\n\n  willLeave () {\n    return { scale: reduceMotion ? 0 : spring(0, { stiffness: 170, damping: 26 }) };\n  }\n\n  render () {\n    const { reactions } = this.props;\n    const visibleReactions = reactions.filter(x => x.get('count') > 0);\n\n    const styles = visibleReactions.map(reaction => ({\n      key: reaction.get('name'),\n      data: reaction,\n      style: { scale: reduceMotion ? 1 : spring(1, { stiffness: 150, damping: 13 }) },\n    })).toArray();\n\n    return (\n      <TransitionMotion styles={styles} willEnter={this.willEnter} willLeave={this.willLeave}>\n        {items => (\n          <div className={classNames('reactions-bar', { 'reactions-bar--empty': visibleReactions.isEmpty() })}>\n            {items.map(({ key, data, style }) => (\n              <Reaction\n                key={key}\n                reaction={data}\n                style={{ transform: `scale(${style.scale})`, position: style.scale < 0.5 ? 'absolute' : 'static' }}\n                announcementId={this.props.announcementId}\n                addReaction={this.props.addReaction}\n                removeReaction={this.props.removeReaction}\n                emojiMap={this.props.emojiMap}\n              />\n            ))}\n\n            {visibleReactions.size < 8 && <EmojiPickerDropdown onPickEmoji={this.handleEmojiPick} button={<Icon id='plus' />} />}\n          </div>\n        )}\n      </TransitionMotion>\n    );\n  }\n\n}\n\nclass Announcement extends ImmutablePureComponent {\n\n  static propTypes = {\n    announcement: ImmutablePropTypes.map.isRequired,\n    emojiMap: ImmutablePropTypes.map.isRequired,\n    addReaction: PropTypes.func.isRequired,\n    removeReaction: PropTypes.func.isRequired,\n    intl: PropTypes.object.isRequired,\n    selected: PropTypes.bool,\n  };\n\n  state = {\n    unread: !this.props.announcement.get('read'),\n  };\n\n  componentDidUpdate () {\n    const { selected, announcement } = this.props;\n    if (!selected && this.state.unread !== !announcement.get('read')) {\n      this.setState({ unread: !announcement.get('read') });\n    }\n  }\n\n  render () {\n    const { announcement } = this.props;\n    const { unread } = this.state;\n    const startsAt = announcement.get('starts_at') && new Date(announcement.get('starts_at'));\n    const endsAt = announcement.get('ends_at') && new Date(announcement.get('ends_at'));\n    const now = new Date();\n    const hasTimeRange = startsAt && endsAt;\n    const skipYear = hasTimeRange && startsAt.getFullYear() === endsAt.getFullYear() && endsAt.getFullYear() === now.getFullYear();\n    const skipEndDate = hasTimeRange && startsAt.getDate() === endsAt.getDate() && startsAt.getMonth() === endsAt.getMonth() && startsAt.getFullYear() === endsAt.getFullYear();\n    const skipTime = announcement.get('all_day');\n\n    return (\n      <div className='announcements__item'>\n        <strong className='announcements__item__range'>\n          <FormattedMessage id='announcement.announcement' defaultMessage='Announcement' />\n          {hasTimeRange && <span>  <FormattedDate value={startsAt} hour12={false} year={(skipYear || startsAt.getFullYear() === now.getFullYear()) ? undefined : 'numeric'} month='short' day='2-digit' hour={skipTime ? undefined : '2-digit'} minute={skipTime ? undefined : '2-digit'} /> - <FormattedDate value={endsAt} hour12={false} year={(skipYear || endsAt.getFullYear() === now.getFullYear()) ? undefined : 'numeric'} month={skipEndDate ? undefined : 'short'} day={skipEndDate ? undefined : '2-digit'} hour={skipTime ? undefined : '2-digit'} minute={skipTime ? undefined : '2-digit'} /></span>}\n        </strong>\n\n        <Content announcement={announcement} />\n\n        <ReactionsBar\n          reactions={announcement.get('reactions')}\n          announcementId={announcement.get('id')}\n          addReaction={this.props.addReaction}\n          removeReaction={this.props.removeReaction}\n          emojiMap={this.props.emojiMap}\n        />\n\n        {unread && <span className='announcements__item__unread' />}\n      </div>\n    );\n  }\n\n}\n\nexport default @injectIntl\nclass Announcements extends ImmutablePureComponent {\n\n  static propTypes = {\n    announcements: ImmutablePropTypes.list,\n    emojiMap: ImmutablePropTypes.map.isRequired,\n    dismissAnnouncement: PropTypes.func.isRequired,\n    addReaction: PropTypes.func.isRequired,\n    removeReaction: PropTypes.func.isRequired,\n    intl: PropTypes.object.isRequired,\n  };\n\n  state = {\n    index: 0,\n  };\n\n  static getDerivedStateFromProps(props, state) {\n    if (props.announcements.size > 0 && state.index >= props.announcements.size) {\n      return { index: props.announcements.size - 1 };\n    } else {\n      return null;\n    }\n  }\n\n  componentDidMount () {\n    this._markAnnouncementAsRead();\n  }\n\n  componentDidUpdate () {\n    this._markAnnouncementAsRead();\n  }\n\n  _markAnnouncementAsRead () {\n    const { dismissAnnouncement, announcements } = this.props;\n    const { index } = this.state;\n    const announcement = announcements.get(announcements.size - 1 - index);\n    if (!announcement.get('read')) dismissAnnouncement(announcement.get('id'));\n  }\n\n  handleChangeIndex = index => {\n    this.setState({ index: index % this.props.announcements.size });\n  }\n\n  handleNextClick = () => {\n    this.setState({ index: (this.state.index + 1) % this.props.announcements.size });\n  }\n\n  handlePrevClick = () => {\n    this.setState({ index: (this.props.announcements.size + this.state.index - 1) % this.props.announcements.size });\n  }\n\n  render () {\n    const { announcements, intl } = this.props;\n    const { index } = this.state;\n\n    if (announcements.isEmpty()) {\n      return null;\n    }\n\n    return (\n      <div className='announcements'>\n        <img className='announcements__mastodon' alt='' draggable='false' src={mascot || elephantUIPlane} />\n\n        <div className='announcements__container'>\n          <ReactSwipeableViews animateHeight={!reduceMotion} adjustHeight={reduceMotion} index={index} onChangeIndex={this.handleChangeIndex}>\n            {announcements.map((announcement, idx) => (\n              <Announcement\n                key={announcement.get('id')}\n                announcement={announcement}\n                emojiMap={this.props.emojiMap}\n                addReaction={this.props.addReaction}\n                removeReaction={this.props.removeReaction}\n                intl={intl}\n                selected={index === idx}\n                disabled={disableSwiping}\n              />\n            )).reverse()}\n          </ReactSwipeableViews>\n\n          {announcements.size > 1 && (\n            <div className='announcements__pagination'>\n              <IconButton disabled={announcements.size === 1} title={intl.formatMessage(messages.previous)} icon='chevron-left' onClick={this.handlePrevClick} size={13} />\n              <span>{index + 1} / {announcements.size}</span>\n              <IconButton disabled={announcements.size === 1} title={intl.formatMessage(messages.next)} icon='chevron-right' onClick={this.handleNextClick} size={13} />\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n}\n"]},"metadata":{"react-intl":{"messages":[{"id":"lightbox.close","defaultMessage":"Close"},{"id":"lightbox.previous","defaultMessage":"Previous"},{"id":"lightbox.next","defaultMessage":"Next"},{"id":"announcement.announcement","defaultMessage":"Announcement"}]}},"sourceType":"module"}