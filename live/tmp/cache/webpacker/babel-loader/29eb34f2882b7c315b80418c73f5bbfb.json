{"ast":null,"code":"var _jsxFileName = \"/home/runner/Mastodon/live/app/javascript/mastodon/features/standalone/public_timeline/index.js\",\n    _dec,\n    _class,\n    _class2,\n    _temp;\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport { expandPublicTimeline, expandCommunityTimeline } from 'mastodon/actions/timelines';\nimport Masonry from 'react-masonry-infinite';\nimport { List as ImmutableList, Map as ImmutableMap } from 'immutable';\nimport DetailedStatusContainer from 'mastodon/features/status/containers/detailed_status_container';\nimport { debounce } from 'lodash';\nimport LoadingIndicator from 'mastodon/components/loading_indicator';\n\nvar mapStateToProps = function mapStateToProps(state, _ref) {\n  var local = _ref.local;\n  var timeline = state.getIn(['timelines', local ? 'community' : 'public'], ImmutableMap());\n  return {\n    statusIds: timeline.get('items', ImmutableList()),\n    isLoading: timeline.get('isLoading', false),\n    hasMore: timeline.get('hasMore', false)\n  };\n};\n\nvar PublicTimeline = (_dec = connect(mapStateToProps), _dec(_class = (_temp = _class2 = /*#__PURE__*/function (_React$PureComponent) {\n  _inheritsLoose(PublicTimeline, _React$PureComponent);\n\n  function PublicTimeline() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$PureComponent.call.apply(_React$PureComponent, [this].concat(args)) || this;\n\n    _this.handleLoadMore = function () {\n      var _this$props = _this.props,\n          dispatch = _this$props.dispatch,\n          statusIds = _this$props.statusIds,\n          local = _this$props.local;\n      var maxId = statusIds.last();\n\n      if (maxId) {\n        dispatch(local ? expandCommunityTimeline({\n          maxId\n        }) : expandPublicTimeline({\n          maxId\n        }));\n      }\n    };\n\n    _this.setRef = function (c) {\n      _this.masonry = c;\n    };\n\n    _this.handleHeightChange = debounce(function () {\n      if (!_this.masonry) {\n        return;\n      }\n\n      _this.masonry.forcePack();\n    }, 50);\n    return _this;\n  }\n\n  var _proto = PublicTimeline.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    this._connect();\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps) {\n    if (prevProps.local !== this.props.local) {\n      this._connect();\n    }\n  };\n\n  _proto._connect = function _connect() {\n    var _this$props2 = this.props,\n        dispatch = _this$props2.dispatch,\n        local = _this$props2.local;\n    dispatch(local ? expandCommunityTimeline() : expandPublicTimeline());\n  };\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    var _this$props3 = this.props,\n        statusIds = _this$props3.statusIds,\n        hasMore = _this$props3.hasMore,\n        isLoading = _this$props3.isLoading;\n    var sizes = [{\n      columns: 1,\n      gutter: 0\n    }, {\n      mq: '415px',\n      columns: 1,\n      gutter: 10\n    }, {\n      mq: '640px',\n      columns: 2,\n      gutter: 10\n    }, {\n      mq: '960px',\n      columns: 3,\n      gutter: 10\n    }, {\n      mq: '1255px',\n      columns: 3,\n      gutter: 10\n    }];\n    var loader = isLoading && statusIds.isEmpty() ? /*#__PURE__*/React.createElement(LoadingIndicator, {\n      key: 0,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 57\n      }\n    }) : undefined;\n    return /*#__PURE__*/React.createElement(Masonry, {\n      ref: this.setRef,\n      className: \"statuses-grid\",\n      hasMore: hasMore,\n      loadMore: this.handleLoadMore,\n      sizes: sizes,\n      loader: loader,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 7\n      }\n    }, statusIds.map(function (statusId) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"statuses-grid__item\",\n        key: statusId,\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(DetailedStatusContainer, {\n        id: statusId,\n        compact: true,\n        measureHeight: true,\n        onHeightChange: _this2.handleHeightChange,\n        __self: _this2,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 13\n        }\n      }));\n    }).toArray());\n  };\n\n  return PublicTimeline;\n}(React.PureComponent), _class2.propTypes = {\n  dispatch: PropTypes.func.isRequired,\n  statusIds: ImmutablePropTypes.list.isRequired,\n  isLoading: PropTypes.bool.isRequired,\n  hasMore: PropTypes.bool.isRequired,\n  local: PropTypes.bool\n}, _temp)) || _class);\nexport { PublicTimeline as default };","map":{"version":3,"sources":["/home/runner/Mastodon/live/app/javascript/mastodon/features/standalone/public_timeline/index.js"],"names":["React","connect","PropTypes","ImmutablePropTypes","expandPublicTimeline","expandCommunityTimeline","Masonry","List","ImmutableList","Map","ImmutableMap","DetailedStatusContainer","debounce","LoadingIndicator","mapStateToProps","state","local","timeline","getIn","statusIds","get","isLoading","hasMore","PublicTimeline","handleLoadMore","props","dispatch","maxId","last","setRef","c","masonry","handleHeightChange","forcePack","componentDidMount","_connect","componentDidUpdate","prevProps","render","sizes","columns","gutter","mq","loader","isEmpty","undefined","map","statusId","toArray","PureComponent","propTypes","func","isRequired","list","bool"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport { expandPublicTimeline, expandCommunityTimeline } from 'mastodon/actions/timelines';\nimport Masonry from 'react-masonry-infinite';\nimport { List as ImmutableList, Map as ImmutableMap } from 'immutable';\nimport DetailedStatusContainer from 'mastodon/features/status/containers/detailed_status_container';\nimport { debounce } from 'lodash';\nimport LoadingIndicator from 'mastodon/components/loading_indicator';\n\nconst mapStateToProps = (state, { local }) => {\n  const timeline = state.getIn(['timelines', local ? 'community' : 'public'], ImmutableMap());\n\n  return {\n    statusIds: timeline.get('items', ImmutableList()),\n    isLoading: timeline.get('isLoading', false),\n    hasMore: timeline.get('hasMore', false),\n  };\n};\n\nexport default @connect(mapStateToProps)\nclass PublicTimeline extends React.PureComponent {\n\n  static propTypes = {\n    dispatch: PropTypes.func.isRequired,\n    statusIds: ImmutablePropTypes.list.isRequired,\n    isLoading: PropTypes.bool.isRequired,\n    hasMore: PropTypes.bool.isRequired,\n    local: PropTypes.bool,\n  };\n\n  componentDidMount () {\n    this._connect();\n  }\n\n  componentDidUpdate (prevProps) {\n    if (prevProps.local !== this.props.local) {\n      this._connect();\n    }\n  }\n\n  _connect () {\n    const { dispatch, local } = this.props;\n\n    dispatch(local ? expandCommunityTimeline() : expandPublicTimeline());\n  }\n\n  handleLoadMore = () => {\n    const { dispatch, statusIds, local } = this.props;\n    const maxId = statusIds.last();\n\n    if (maxId) {\n      dispatch(local ? expandCommunityTimeline({ maxId }) : expandPublicTimeline({ maxId }));\n    }\n  }\n\n  setRef = c => {\n    this.masonry = c;\n  }\n\n  handleHeightChange = debounce(() => {\n    if (!this.masonry) {\n      return;\n    }\n\n    this.masonry.forcePack();\n  }, 50)\n\n  render () {\n    const { statusIds, hasMore, isLoading } = this.props;\n\n    const sizes = [\n      { columns: 1, gutter: 0 },\n      { mq: '415px', columns: 1, gutter: 10 },\n      { mq: '640px', columns: 2, gutter: 10 },\n      { mq: '960px', columns: 3, gutter: 10 },\n      { mq: '1255px', columns: 3, gutter: 10 },\n    ];\n\n    const loader = (isLoading && statusIds.isEmpty()) ? <LoadingIndicator key={0} /> : undefined;\n\n    return (\n      <Masonry ref={this.setRef} className='statuses-grid' hasMore={hasMore} loadMore={this.handleLoadMore} sizes={sizes} loader={loader}>\n        {statusIds.map(statusId => (\n          <div className='statuses-grid__item' key={statusId}>\n            <DetailedStatusContainer\n              id={statusId}\n              compact\n              measureHeight\n              onHeightChange={this.handleHeightChange}\n            />\n          </div>\n        )).toArray()}\n      </Masonry>\n    );\n  }\n\n}\n"]},"metadata":{"react-intl":{"messages":[]}},"sourceType":"module"}